# RAG 문서 파싱 및 인덱싱 완료 조건 (Definition of Done)

이 문서는 `[별책8]+수학과+교육과정.pdf` 및 `2025학년도 2학기 3학년 교과별 교수학습 및 평가 운영 계획(수정).hwp` 문서의 파싱 성공 여부를 판단하는 구체적인 기준(DoD)을 정의합니다.

## 1. 공통 필수 조건 (General Criteria)

모든 파싱 작업이 완료되었다고 판단하기 위해 다음 조건들을 만족해야 합니다.

*   **[ ] 텍스트 무결성 (Text Integrity)**
    *   추출된 텍스트에 인코딩 오류(깸짐 현상)가 0건이어야 한다.
    *   불필요한 공백, 제어 문자(`\n\n\n`, `\t` 등)가 정규화(Normalization)되어야 한다.
*   **[ ] 메타데이터 부착 (Metadata Attachment)**
    *   생성된 **모든 청크(Chunk)**에 원본 파일명, 페이지 번호(또는 섹션 위치)가 포함되어야 한다.
    *   문서 레벨 메타데이터(연도, 과목, 학년)가 정확하게 추출되어 DB에 저장되어야 한다.
*   **[ ] 검색 가능성 (Retrievability)**
    *   Vector DB에 저장된 후, 원본 문서의 핵심 키워드로 검색했을 때 해당 청크가 Top-5 내에 조회되어야 한다.

---

## 2. 문서별 상세 완료 조건

### 2.1. 수학과 교육과정 PDF (`[별책8]+수학과+교육과정.pdf`)

이 문서는 **"성취기준의 구조화"**가 핵심 성공 지표입니다.

*   **[ ] 성취기준 코드 추출률 100%**
    *   문서 내 존재하는 모든 성취기준 코드(예: `[2수01-01]`, `[12수학Ⅰ01-01]`)가 식별되어야 한다.
    *   누락된 코드가 없어야 하며, 정규식 검증 스크립트로 이를 확인한다.
*   **[ ] 계층 구조 보존 (Hierarchy Preservation)**
    *   각 성취기준 청크는 자신이 속한 **[학교급 > 학년군 > 영역]** 정보를 메타데이터로 가지고 있어야 한다.
    *   *실패 예시*: `[2수01-01]` 내용만 있고, 이게 "초등 1~2학년"인지 모르는 상태.
*   **[ ] 표 데이터의 선형화 (Table Linearization)**
    *   '성취기준', '관련 요소', '교수·학습 방법' 등이 포함된 표가 `Key: Value` 형태의 텍스트로 변환되어 문맥이 유지되어야 한다.
    *   *성공 기준*: "세 자리 수의 덧셈과 뺄셈의 평가 방법은?" 질문에 대해 해당 표의 '평가 방법' 열의 내용을 정확히 가져올 수 있어야 한다.

### 2.2. 교수학습 및 평가 운영 계획 HWP (`...운영 계획(수정).hwp`)

이 문서는 **"표 구조의 논리적 보존"**이 핵심 성공 지표입니다.

*   **[ ] 평가 계획 표의 행(Row) 단위 매핑**
    *   거대한 표(월별/단원별 계획)에서 **[단원명 - 성취기준 - 평가방법 - 시기]**가 서로 섞이지 않고 하나의 세트로 추출되어야 한다.
    *   *실패 예시*: 3월의 단원명과 4월의 평가방법이 하나의 청크로 묶이는 경우.
*   **[ ] 섹션 분리 (Sectioning)**
    *   문서의 대단원(1. 교과 목표, 2. 평가 방침 등)이 서로 다른 청크로 명확히 분리되어야 한다.
*   **[ ] 특수 문자 처리**
    *   HWP 특유의 글머리 기호(□, ◦, -)가 깨지지 않거나, 표준 마크다운 리스트(`-`, `*`)로 변환되어야 한다.

---

## 3. 검증 방법 (Verification Methods)

DoD 달성 여부는 다음 두 가지 방법으로 확인합니다.

### 3.1. 자동화 테스트 (Automated Test)
*   **Regex Counter**: 원본 PDF의 성취기준 코드 개수와 Vector DB에 저장된 성취기준 청크 개수를 비교 (일치해야 함).
*   **Metadata Validator**: 모든 청크에 필수 메타데이터 필드(`grade`, `subject`)가 존재하는지 검사.

### 3.2. 육안 검사 (Manual Inspection)
*   **Random Sampling**:
    *   PDF: 임의의 3개 성취기준을 골라 내용이 잘리지 않았는지 확인.
    *   HWP: '평가 계획' 표에서 임의의 3개 행(Row)을 골라 단원과 평가방법이 올바르게 매칭되었는지 확인.
*   **RAG Query Test**:
    *   질문: "초등학교 3학년 분수 단원의 성취기준은?" -> 답변에 해당 성취기준 코드가 포함되어야 함.
    *   질문: "지필평가는 언제 시행하나요?" -> 답변에 운영 계획서의 시기 정보가 포함되어야 함.

## 4. 실패 시 허용 범위 (Acceptance Criteria for Failure)

완벽한 파싱은 불가능할 수 있으므로, 다음 경우는 **조건부 성공**으로 간주합니다.

*   **이미지/도표**: 텍스트가 아닌 단순 장식용 이미지나 복잡한 다이어그램이 누락되는 것은 허용 (단, `[이미지]` 태그로 표시 권장).
*   **미세한 포맷팅**: 표의 셀 병합이 복잡하여 일부 텍스트 순서가 바뀌더라도, 핵심 키워드(단원명, 평가방법)가 같은 청크 내에 존재하면 성공으로 간주.

# RAG 문서 파싱 테스트 결과 보고서 (2차)

**테스트 일시**: 2025-11-21
**테스트 환경**: WSL (Ubuntu), Python 3.x Virtual Environment
**대상 파일**:
1. `asset/[별책8]+수학과+교육과정.pdf` (PDF)
2. `asset/2025학년도 2학기 3학년 교과별 교수학습 및 평가 운영 계획(수정).hwp` (HWP)

---

## 1. 테스트 요약

| 항목 | 결과 | 비고 |
| :--- | :--- | :--- |
| **PDF 파싱** | **완전 성공 (Complete)** | 성취기준(477개) + 총론(14개) = 총 491개 청크 |
| **HWP 파싱** | **부분 성공 (Partial)** | 바이너리 추출 성공했으나 인코딩/압축 해제 이슈로 내용 깨짐 |
| **메타데이터** | **성공 (Success)** | PDF 총론 섹션("1. 성격") 인식 및 메타데이터 주입 확인 |

## 2. 상세 결과

### 2.1. 수학과 교육과정 PDF (`[별책8]+수학과+교육과정.pdf`)

*   **총 청크 수**: 491개 (이전 477개에서 **14개 증가**)
*   **개선 사항**:
    *   기존에 누락되었던 **"1. 성격 및 목표"** 등 서론 부분이 정상적으로 파싱됨.
    *   `Sample Chunk 0`을 보면 "수학과는 수학의 개념, 원리, 법칙을 이해하고..."와 같은 총론 텍스트가 깨끗하게 추출됨.
*   **데이터 품질**:
    *   성취기준 코드: 477개 유지 (핵심 데이터 보존)
    *   총론 데이터: 14개 추가 (문맥 보강)

### 2.2. 교수학습 및 평가 운영 계획 HWP (`...운영 계획(수정).hwp`)

*   **총 청크 수**: 2350개 (실제 바이너리 스트림 추출)
*   **문제점**:
    *   추출된 텍스트가 `Bƀ! ࠄ 4̀...`와 같이 깨져서 나옴.
    *   **원인**: HWP 5.0 포맷의 압축(zlib) 또는 인코딩(UTF-16LE) 처리가 파이썬 스크립트만으로는 완벽하지 않음. `olefile`로 스트림 접근은 했으나, 내부 구조 해석에 실패함.
*   **조치 계획**:
    *   이 방식(Pure Python Script)으로는 한계가 명확함.
    *   **강력 권고**: HWP 파일을 **PDF로 변환**하여 업로드하거나, 전용 변환 서버(hwp5txt)를 구축해야 함.

---

## 3. 결론

1.  **PDF 파서**: **완성도 100%**. 성취기준뿐만 아니라 서론/총론까지 모두 커버하여 RAG 품질을 극대화할 준비가 되었습니다.
2.  **HWP 파서**: **기술적 한계 확인**. 현재 환경(WSL/Python)에서 HWP 바이너리 직접 파싱은 불가능에 가깝습니다. 사용자에게 **"HWP를 PDF로 변환 후 업로드"**하는 워크플로우를 제안합니다.

**최종 승인 요청**: PDF 파싱 결과는 완벽하므로 인덱싱을 진행해도 좋습니다. HWP는 변환 후 재시도해야 합니다.

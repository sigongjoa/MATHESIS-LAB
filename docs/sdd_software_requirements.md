# 요구사항 명세서 (SRS - Software Requirements Specification)

## 1. 개요
이 문서는 'MATHESIS LAB' 프로젝트의 기능 및 비기능 요구사항을 상세히 정의합니다. 기획서 v4.0을 기반으로 개발자가 구현할 수 있는 수준의 구체적인 명세를 제공하여, 프로젝트의 목표와 범위를 명확히 합니다.

## 2. 기능 요구사항

### 2.1. 커리큘럼 맵 관리
*   **기능명:** 커리큘럼 맵 생성 및 편집
    *   **설명:** 사용자는 새로운 커리큘럼 맵을 생성하고, 기존 맵의 제목, 설명 등을 편집할 수 있다.
    *   **입력:** 맵 제목, 설명
    *   **처리:** 백엔드는 요청을 받아 커리큘럼 맵 데이터를 생성/업데이트한다.
    *   **출력:** 생성/업데이트된 커리큘럼 맵 정보
    *   **예외:** 필수 필드 누락 시 오류 반환.
*   **기능명:** 커리큘럼 맵 노드 추가/편집/삭제
    *   **설명:** 사용자는 커리큘럼 맵 내에 노드를 추가, 편집(제목, 내용), 삭제할 수 있다.
    *   **입력:** 노드 제목, 내용, 부모 노드 ID (추가 시), 노드 ID (편집/삭제 시)
    *   **처리:** 백엔드는 요청을 받아 노드 데이터를 생성/업데이트/삭제한다.
    *   **출력:** 변경된 노드 정보 또는 성공 메시지
    *   **예외:** 존재하지 않는 노드 ID 요청 시, 권한 없는 사용자 요청 시 오류 반환.
*   **기능명:** 커리큘럼 맵 노드 순서 변경 (드래그 앤 드롭)
    *   **설명:** 사용자는 커리큘럼 맵 내에서 노드의 위치를 드래그 앤 드롭으로 변경하여 학습 순서를 재조정할 수 있다.
    *   **입력:** 드래그 시작 노드 ID, 드롭 대상 노드 ID, 드롭 위치 (상대적 순서)
    *   **처리:** 백엔드는 노드 순서 변경 요청을 받아 해당 커리큘럼 맵의 노드 순서 데이터를 업데이트한다.
    *   **출력:** 업데이트된 커리큘럼 맵 데이터 (새로운 노드 순서 반영)
    *   **예외:** 유효하지 않은 순서 변경 요청 시 오류 반환.

### 2.2. Zotero 연동
*   **기능명:** Zotero 라이브러리 문헌 검색 (태그 기반)
    *   **설명:** 사용자는 Zotero 라이브러리에서 특정 태그가 붙은 문헌을 검색할 수 있다.
    *   **입력:** 검색 태그 (예: "난류")
    *   **처리:** 백엔드는 자체 호스팅 Zotero 서버의 DB에서 태그에 해당하는 문헌을 조회한다.
    *   **출력:** 검색된 문헌 목록 (제목, 저자, 연도, 태그 등)
    *   **예외:** 검색 결과가 없을 시 "검색 결과 없음" 메시지 반환.
*   **기능명:** Zotero 문헌을 커리큘럼 맵 노드에 연결
    *   **설명:** 검색된 Zotero 문헌을 커리큘럼 맵의 특정 노드에 연결하여 참고 자료로 활용할 수 있다.
    *   **입력:** 노드 ID, Zotero 문헌 ID
    *   **처리:** 백엔드는 노드와 문헌 간의 연결 정보를 저장한다.
    *   **출력:** 연결 성공 메시지 또는 업데이트된 노드 정보
    *   **예외:** 이미 연결된 문헌이거나 유효하지 않은 ID 시 오류 반환.

### 2.3. AI 보조 작가 (LLM) 기능
*   **기능명:** 이미지 기반 Manim 코드 가이드라인 생성
    *   **설명:** 사용자가 이미지를 업로드하면, AI 보조 작가가 해당 이미지에 대한 Manim 코드 생성 가이드라인을 텍스트로 제공한다.
    *   **입력:** 이미지 파일, 사용자 프롬프트 (선택 사항)
    *   **처리:** 백엔드는 Vertex AI (Gemini Pro Vision)를 호출하여 이미지 분석 및 텍스트 생성을 요청한다.
    *   **출력:** Manim 코드 생성 가이드라인 텍스트
    *   **예외:** 이미지 분석 실패 시, 응답 시간 초과 시 오류 반환.
*   **기능명:** 노드 내용 기반 요약/확장/질의응답
    *   **설명:** 사용자는 커리큘럼 맵 노드의 내용을 기반으로 AI에게 요약, 내용 확장, 특정 질문에 대한 답변을 요청할 수 있다.
    *   **입력:** 노드 ID, AI 요청 유형 (요약, 확장, 질의응답), 질의 내용 (질의응답 시)
    *   **처리:** 백엔드는 Vertex AI (Gemini)를 호출하여 요청을 처리한다.
    *   **출력:** AI가 생성한 텍스트 (요약, 확장된 내용, 답변)
    *   **예외:** 노드 내용이 없거나 AI 응답 실패 시 오류 반환.

### 2.4. YouTube 연동
*   **기능명:** YouTube 영상 링크를 노드에 연결
    *   **설명:** 사용자는 YouTube 영상 링크를 커리큘럼 맵 노드에 연결하여 학습 자료로 활용할 수 있다.
    *   **입력:** 노드 ID, YouTube 영상 URL
    *   **처리:** 백엔드는 YouTube URL의 유효성을 검사하고, 노드와 영상 간의 연결 정보를 저장한다.
    *   **출력:** 연결 성공 메시지 또는 업데이트된 노드 정보
    *   **예외:** 유효하지 않은 YouTube URL 시 오류 반환.
*   **기능명:** 연결된 YouTube 영상 시청
    *   **설명:** 사용자는 노드에 연결된 YouTube 영상을 커리큘럼 맵 내에서 직접 시청할 수 있다.
    *   **입력:** 노드 ID
    *   **처리:** 프론트엔드는 노드에 연결된 영상 URL을 가져와 임베드된 플레이어로 영상을 재생한다.
    *   **출력:** 영상 플레이어
    *   **예외:** 영상 URL이 없거나 유효하지 않을 시 오류 메시지.

## 3. 비기능 요구사항

### 3.1. 성능
*   **응답 시간:**
    *   일반적인 웹 페이지 로딩 시간은 3초 이내여야 한다.
    *   AI 보조 작가(LLM)의 응답 시간은 평균 5초 이내여야 하며, 최대 10초를 초과하지 않아야 한다.
    *   Zotero 문헌 검색 응답 시간은 2초 이내여야 한다.
*   **처리량:** 동시 사용자 1,000명까지 안정적으로 서비스되어야 한다.

### 3.2. 보안
*   **인증/인가:** GCP IAP(Identity-Aware Proxy)를 통한 단일 사용자 인증을 구현한다.
*   **처리량:** (단일 사용자 프로젝트이므로 특정 처리량 요구사항은 없음)
*   **데이터 보호:** 민감한 사용자 데이터 및 문헌 정보는 전송 및 저장 시 암호화되어야 한다.
*   **취약점 관리:** OWASP Top 10 취약점에 대한 방어 전략을 수립하고 적용한다.

### 3.3. 사용성
*   **직관적인 UI/UX:** 커리큘럼 맵의 드래그 앤 드롭 기능은 직관적이고 부드러워야 한다.
*   **접근성:** 웹 표준을 준수하여 다양한 기기 및 환경에서 접근 가능해야 한다.

### 3.4. 확장성
*   **수평 확장:** Cloud Run, GKE 등 GCP 서비스를 활용하여 트래픽 증가에 따라 유연하게 수평 확장이 가능해야 한다.
*   **모듈화:** 각 기능은 독립적인 모듈로 설계하여 향후 기능 추가 및 변경이 용이해야 한다.

### 3.5. 유지보수성
*   **코드 품질:** 클린 코드 원칙을 준수하고, 코드 리뷰 프로세스를 통해 코드 품질을 유지한다.
*   **로깅/모니터링:** Cloud Logging 및 Cloud Monitoring을 활용하여 시스템 상태를 실시간으로 모니터링하고 문제 발생 시 신속하게 대응할 수 있어야 한다.

### 3.6. 배포
*   **CI/CD:** GitHub Actions를 활용하여 자동화된 빌드, 테스트, 배포 파이프라인을 구축한다.

### 3.7. 비용 예측 (Cost Estimation)
*   **목적:** GCP 서비스 사용에 따른 예상 비용을 추정하고 관리한다.
*   **내용:**
    *   Cloud Run: 요청 수, CPU 사용량, 메모리 사용량 기반.
    *   Cloud SQL: 인스턴스 유형, 스토리지, 네트워크 사용량 기반.
    *   GKE: 노드 수, 유형, 스토리지 기반 (Zotero 서버).
    *   Cloud Storage: 저장 용량, 작업 수, 네트워크 사용량 기반.
    *   Vertex AI: 모델 호출 횟수, 처리량 기반.
    *   예상 월별 비용 범위 추정 및 비용 알림 설정.

### 3.8. 모니터링 계획 (Monitoring Plan)
*   **목적:** 시스템의 성능, 가용성, 오류를 지속적으로 감시하고 문제 발생 시 신속하게 대응한다.
*   **내용:**
    *   **지표 수집:** Cloud Monitoring을 사용하여 CPU 사용률, 메모리 사용률, 네트워크 트래픽, 요청 지연 시간, 오류율 등 핵심 지표를 수집한다.
    *   **알림:** 임계값 초과 시 Cloud Monitoring Alerting을 통해 관리자에게 알림(이메일, Slack 등)을 전송한다.
    *   **로깅:** Cloud Logging을 사용하여 애플리케이션 및 시스템 로그를 중앙 집중화하고, 오류 및 경고 로그를 분석한다.
    *   **대시보드:** Cloud Monitoring 대시보드를 구성하여 시스템 상태를 시각적으로 모니터링한다.

## 4. 용어 정의
*   **노드 (Node):** 커리큘럼 맵의 최소 단위로, 학습 주제, 개념, 자료 등을 나타낸다.
*   **커리큘럼 맵 (Curriculum Map):** 노드들로 구성된 학습 경로 또는 지식 체계.
*   **Zotero:** 문헌 관리 도구.
*   **Manim:** 파이썬 기반 애니메이션 라이브러리.
*   **Vertex AI:** Google Cloud의 머신러닝 플랫폼.
*   **LLM (Large Language Model):** 대규모 언어 모델.
